
declare

v_cnt      NUMBER;
v_cnt_conv NUMBER;
v_cnt_prod NUMBER;
record_count_mismatch exception;

begin
for i in
(
SELECT 
  APCTRL_COMP_CODE,
  APCTRL_DEPT_CODE,
  APCTRL_AP_DEPT_CODE,
  APCTRL_AP_ACC_CODE,
  APCTRL_EXP_DEPT_CODE,
  APCTRL_EXP_ACC_CODE,
  APCTRL_HLDBK_DEPT_CODE,
  APCTRL_HLDBK_ACC_CODE,
  APCTRL_DISC_DEPT_CODE,
  APCTRL_DISC_ACC_CODE,
  APCTRL_CASH_DEPT_CODE,
  APCTRL_CASH_ACC_CODE,
  APCTRL_TAX_DEPT_CODE,
  APCTRL_TAX_ACC_CODE,
  APCTRL_FRT_DEPT_CODE,
  APCTRL_FRT_ACC_CODE,
  APCTRL_MISC_DEPT_CODE,
  APCTRL_MISC_ACC_CODE,
  APCTRL_CURR_FLUC_DEPT_CODE,
  APCTRL_CURR_FLUC_ACC_CODE,
  APCTRL_CLAIM_DEPT_CODE,
  APCTRL_CLAIM_ACC_CODE,
  APCTRL_DISC_CODE,
  APCTRL_POST_CODE,
  APCTRL_SUMMARY_CODE,
  APCTRL_JOUR_CODE,
  APCTRL_CD_JOUR_CODE,
  APCTRL_VOU_OR_DUE,
  APCTRL_CHQ_PRT_TYPE,
  APCTRL_CHQ_LINES,
  APCTRL_CHQ_NAME,
  APCTRL_REP1_NAME,
  APCTRL_HLDBK_TYPE_CODE,
  APCTRL_PO_AUTCL_CODE,
  APCTRL_SC_CODE,
  APCTRL_H_CODE,
  APCTRL_REC_H_CODE,
  APCTRL_CHQ_H_NUM,
  APCTRL_VOU_H_NUM,
  APCTRL_CHQ_ZFLAG,
  APCTRL_CHQ_REL_FLAG,
  APCTRL_INV_SERIES_FLAG,
  APCTRL_VERIFY_POAMT_FLAG,
  APCTRL_VERIFY_PO_FLAG,
  APCTRL_VERIFY_SC_FLAG,
  APCTRL_DFTTAX_CODE,
  APCTRL_TAX1_TYPE_CODE,
  APCTRL_DFT_VOU_DATE_FLAG,
  APCTRL_1099_FLAG,
  APCTRL_CHQ_XFLAG,
  APCTRL_CURR_YR,
  APCTRL_CURR_PER,
  APCTRL_STUB_LINES,
  APCTRL_RESTRICT_POST_FLAG,
  APCTRL_VERIFY_POVAR_AMT,
  APCTRL_ACCT_DFLT_STATE,
  APCTRL_TAX2_HLDBK_FLAG,
  APCTRL_CHQ_STUB_SORT_CODE,
  APCTRL_PRT_DEF,
  APCTRL_CHECK_MERGE_FLAG,
  APCTRL_SUMMARY_RETAIN_RLS_FLAG,
  APCTRL_APRV_REG_INV_FLAG,
  APCTRL_DEFAULT_TERM_CODE,
  APCTRL_FUTURE_POST_FLAG,
  APCTRL_DESC_REQD_FLAG,
  APCTRL_RECURR_VOU_PREFIX,
  APCTRL_RECURR_NEXT_SEQ_NUM,
  APCTRL_RECURR_LAST_BCH_NUM,
  APCTRL_RECURR_LAST_SEQ_NUM,
  APCTRL_PO_VAR_DEPT_CODE,
  APCTRL_PO_VAR_ACC_CODE,
  APCTRL_ALLOW_DUP_CHEQUE_FLAG,
  APCTRL_USE_JOB_BANK_ACCT_FLAG,
  APCTRL_CLOSE_0_PO_LINES_FLAG,
  APCTRL_VOUCHER_HOLD_FLAG,
  APCTRL_USE_VOU_ACC_FLAG,
  APCTRL_PPE_DEPT_CODE,
  APCTRL_PPE_ACC_CODE,
  APCTRL_DEFAULT_PAY_CODE,
  APCTRL_AUTO_CHECK_POST_FLAG,
  APCTRL_USE_CHQ_VOU_CODE_FLAG,
  APCTRL_INV_NUM_USED_WARN,
  APCTRL_CHECK_DUPL_VEN_AMT_FLAG,
  APCTRL_DUPL_VEN_AMOUNT,
  APCTRL_DUPL_VEN_AMT_MONTH,
  APCTRL_EFT_STUB_NAME,
  APCTRL_EFT_FILE_FORMAT,
  APCTRL_EFT_FILE_CODE,
  APCTRL_CHQ_ORDER_FLAG,
  APCTRL_VEN_ADD_REQD_FLAG,
  APCTRL_DIRECT_TAX_VOU_FLAG,
  APCTRL_ALLOCATE_ITEMS_IN_REG,
  APCTRL_PART_PAID_VOU_DFLT_STAT,
  APCTRL_RAISE_VAR_ERROR_FLAG,
  APCTRL_POP_CHQ_REL_DATE_FLAG,
  APCTRL_ALLOW_DATE_NOT_CURR_PER,
  APCTRL_VERIFY_SC_STRUCT_FLAG,
  APCTRL_TOTAL_PO_VARIANCE_AMT,
  APCTRL_TOTAL_PO_VARIANCE_PC,
  APCTRL_VARIANCE_ACCESS_FLAG,
  APCTRL_USE_PO_TERMS_FLAG,
  APCTRL_MULTIPLE_DIR_TAXES_FLAG,
  APCTRL_USE_PAY_WHEN_PAID_FLAG,
  APCTRL_PAY_WHEN_PAID_DAYS,
  APCTRL_PREDATED_CHECKS,
  APCTRL_BCH_TOTAL_FLAG,
  APCTRL_SEP_VOU_PER_JOB_FLAG,
  APCTRL_ALTERNATE_ADDRESS_EXIST,
  APCTRL_AUTO_DRAW_NUM_FLAG,
  APCTRL_COMPL_DATE_SENS,
  APCTRL_KEEP_FUTURE_DUE_DATE,
  APCTRL_INV_MRKT_PRC_BILL_RATE,
  APCTRL_MATRECEIPT_AUTONUM_FLAG,
  APCTRL_MATRECEIPT_NUM_MASK,
  APCTRL_SLER_DEPT_CODE,
  APCTRL_SLER_ACC_CODE,
  APCTRL_SLIR_DEPT_CODE,
  APCTRL_SLIR_ACC_CODE,
  APCTRL_CHECK_POST_DATE_FLAG,
  --APCTRL__IU__CREATE_DATE,
  --APCTRL__IU__CREATE_USER,
  --APCTRL__IU__UPDATE_DATE,
  --APCTRL__IU__UPDATE_USER,
  APCTRL_USE_PRELIEN_FLAG,
  APCTRL_GROUP_CHK_BY_JP_FLAG,
  APCTRL_PRELIEN_TYPE_CODE,
  APCTRL_SELPAY_USER_WARN_FLAG
FROM DA.APCTRL@CONV 
WHERE apctrl_comp_code not in ('ZZ')
) loop
INSERT INTO DA.APCTRL
(  
  APCTRL_COMP_CODE,
  APCTRL_DEPT_CODE,
  APCTRL_AP_DEPT_CODE,
  APCTRL_AP_ACC_CODE,
  APCTRL_EXP_DEPT_CODE,
  APCTRL_EXP_ACC_CODE,
  APCTRL_HLDBK_DEPT_CODE,
  APCTRL_HLDBK_ACC_CODE,
  APCTRL_DISC_DEPT_CODE,
  APCTRL_DISC_ACC_CODE,
  APCTRL_CASH_DEPT_CODE,
  APCTRL_CASH_ACC_CODE,
  APCTRL_TAX_DEPT_CODE,
  APCTRL_TAX_ACC_CODE,
  APCTRL_FRT_DEPT_CODE,
  APCTRL_FRT_ACC_CODE,
  APCTRL_MISC_DEPT_CODE,
  APCTRL_MISC_ACC_CODE,
  APCTRL_CURR_FLUC_DEPT_CODE,
  APCTRL_CURR_FLUC_ACC_CODE,
  APCTRL_CLAIM_DEPT_CODE,
  APCTRL_CLAIM_ACC_CODE,
  APCTRL_DISC_CODE,
  APCTRL_POST_CODE,
  APCTRL_SUMMARY_CODE,
  APCTRL_JOUR_CODE,
  APCTRL_CD_JOUR_CODE,
  APCTRL_VOU_OR_DUE,
  APCTRL_CHQ_PRT_TYPE,
  APCTRL_CHQ_LINES,
  APCTRL_CHQ_NAME,
  APCTRL_REP1_NAME,
  APCTRL_HLDBK_TYPE_CODE,
  APCTRL_PO_AUTCL_CODE,
  APCTRL_SC_CODE,
  APCTRL_H_CODE,
  APCTRL_REC_H_CODE,
  APCTRL_CHQ_H_NUM,
  APCTRL_VOU_H_NUM,
  APCTRL_CHQ_ZFLAG,
  APCTRL_CHQ_REL_FLAG,
  APCTRL_INV_SERIES_FLAG,
  APCTRL_VERIFY_POAMT_FLAG,
  APCTRL_VERIFY_PO_FLAG,
  APCTRL_VERIFY_SC_FLAG,
  APCTRL_DFTTAX_CODE,
  APCTRL_TAX1_TYPE_CODE,
  APCTRL_DFT_VOU_DATE_FLAG,
  APCTRL_1099_FLAG,
  APCTRL_CHQ_XFLAG,
  APCTRL_CURR_YR,
  APCTRL_CURR_PER,
  APCTRL_STUB_LINES,
  APCTRL_RESTRICT_POST_FLAG,
  APCTRL_VERIFY_POVAR_AMT,
  APCTRL_ACCT_DFLT_STATE,
  APCTRL_TAX2_HLDBK_FLAG,
  APCTRL_CHQ_STUB_SORT_CODE,
  APCTRL_PRT_DEF,
  APCTRL_CHECK_MERGE_FLAG,
  APCTRL_SUMMARY_RETAIN_RLS_FLAG,
  APCTRL_APRV_REG_INV_FLAG,
  APCTRL_DEFAULT_TERM_CODE,
  APCTRL_FUTURE_POST_FLAG,
  APCTRL_DESC_REQD_FLAG,
  APCTRL_RECURR_VOU_PREFIX,
  APCTRL_RECURR_NEXT_SEQ_NUM,
  APCTRL_RECURR_LAST_BCH_NUM,
  APCTRL_RECURR_LAST_SEQ_NUM,
  APCTRL_PO_VAR_DEPT_CODE,
  APCTRL_PO_VAR_ACC_CODE,
  APCTRL_ALLOW_DUP_CHEQUE_FLAG,
  APCTRL_USE_JOB_BANK_ACCT_FLAG,
  APCTRL_CLOSE_0_PO_LINES_FLAG,
  APCTRL_VOUCHER_HOLD_FLAG,
  APCTRL_USE_VOU_ACC_FLAG,
  APCTRL_PPE_DEPT_CODE,
  APCTRL_PPE_ACC_CODE,
  APCTRL_DEFAULT_PAY_CODE,
  APCTRL_AUTO_CHECK_POST_FLAG,
  APCTRL_USE_CHQ_VOU_CODE_FLAG,
  APCTRL_INV_NUM_USED_WARN,
  APCTRL_CHECK_DUPL_VEN_AMT_FLAG,
  APCTRL_DUPL_VEN_AMOUNT,
  APCTRL_DUPL_VEN_AMT_MONTH,
  APCTRL_EFT_STUB_NAME,
  APCTRL_EFT_FILE_FORMAT,
  APCTRL_EFT_FILE_CODE,
  APCTRL_CHQ_ORDER_FLAG,
  APCTRL_VEN_ADD_REQD_FLAG,
  APCTRL_DIRECT_TAX_VOU_FLAG,
  APCTRL_ALLOCATE_ITEMS_IN_REG,
  APCTRL_PART_PAID_VOU_DFLT_STAT,
  APCTRL_RAISE_VAR_ERROR_FLAG,
  APCTRL_POP_CHQ_REL_DATE_FLAG,
  APCTRL_ALLOW_DATE_NOT_CURR_PER,
  APCTRL_VERIFY_SC_STRUCT_FLAG,
  APCTRL_TOTAL_PO_VARIANCE_AMT,
  APCTRL_TOTAL_PO_VARIANCE_PC,
  APCTRL_VARIANCE_ACCESS_FLAG,
  APCTRL_USE_PO_TERMS_FLAG,
  APCTRL_MULTIPLE_DIR_TAXES_FLAG,
  APCTRL_USE_PAY_WHEN_PAID_FLAG,
  APCTRL_PAY_WHEN_PAID_DAYS,
  APCTRL_PREDATED_CHECKS,
  APCTRL_BCH_TOTAL_FLAG,
  APCTRL_SEP_VOU_PER_JOB_FLAG,
  APCTRL_ALTERNATE_ADDRESS_EXIST,
  APCTRL_AUTO_DRAW_NUM_FLAG,
  APCTRL_COMPL_DATE_SENS,
  APCTRL_KEEP_FUTURE_DUE_DATE,
  APCTRL_INV_MRKT_PRC_BILL_RATE,
  APCTRL_MATRECEIPT_AUTONUM_FLAG,
  APCTRL_MATRECEIPT_NUM_MASK,
  APCTRL_SLER_DEPT_CODE,
  APCTRL_SLER_ACC_CODE,
  APCTRL_SLIR_DEPT_CODE,
  APCTRL_SLIR_ACC_CODE,
  APCTRL_CHECK_POST_DATE_FLAG,
  --APCTRL__IU__CREATE_DATE,
  --APCTRL__IU__CREATE_USER,
  --APCTRL__IU__UPDATE_DATE,
  --APCTRL__IU__UPDATE_USER,
  APCTRL_USE_PRELIEN_FLAG,
  APCTRL_GROUP_CHK_BY_JP_FLAG,
  APCTRL_PRELIEN_TYPE_CODE,
  APCTRL_SELPAY_USER_WARN_FLAG
)
values
(
i.  APCTRL_COMP_CODE,
i.  APCTRL_DEPT_CODE,
i.  APCTRL_AP_DEPT_CODE,
i.  APCTRL_AP_ACC_CODE,
i.  APCTRL_EXP_DEPT_CODE,
i.  APCTRL_EXP_ACC_CODE,
i.  APCTRL_HLDBK_DEPT_CODE,
i.  APCTRL_HLDBK_ACC_CODE,
i.  APCTRL_DISC_DEPT_CODE,
i.  APCTRL_DISC_ACC_CODE,
i.  APCTRL_CASH_DEPT_CODE,
i.  APCTRL_CASH_ACC_CODE,
i.  APCTRL_TAX_DEPT_CODE,
i.  APCTRL_TAX_ACC_CODE,
i.  APCTRL_FRT_DEPT_CODE,
i.  APCTRL_FRT_ACC_CODE,
i.  APCTRL_MISC_DEPT_CODE,
i.  APCTRL_MISC_ACC_CODE,
i.  APCTRL_CURR_FLUC_DEPT_CODE,
i.  APCTRL_CURR_FLUC_ACC_CODE,
i.  APCTRL_CLAIM_DEPT_CODE,
i.  APCTRL_CLAIM_ACC_CODE,
i.  APCTRL_DISC_CODE,
i.  APCTRL_POST_CODE,
i.  APCTRL_SUMMARY_CODE,
i.  APCTRL_JOUR_CODE,
i.  APCTRL_CD_JOUR_CODE,
i.  APCTRL_VOU_OR_DUE,
i.  APCTRL_CHQ_PRT_TYPE,
i.  APCTRL_CHQ_LINES,
i.  APCTRL_CHQ_NAME,
i.  APCTRL_REP1_NAME,
i.  APCTRL_HLDBK_TYPE_CODE,
i.  APCTRL_PO_AUTCL_CODE,
i.  APCTRL_SC_CODE,
i.  APCTRL_H_CODE,
i.  APCTRL_REC_H_CODE,
i.  APCTRL_CHQ_H_NUM,
i.  APCTRL_VOU_H_NUM,
i.  APCTRL_CHQ_ZFLAG,
i.  APCTRL_CHQ_REL_FLAG,
i.  APCTRL_INV_SERIES_FLAG,
i.  APCTRL_VERIFY_POAMT_FLAG,
i.  APCTRL_VERIFY_PO_FLAG,
i.  APCTRL_VERIFY_SC_FLAG,
i.  APCTRL_DFTTAX_CODE,
i.  APCTRL_TAX1_TYPE_CODE,
i.  APCTRL_DFT_VOU_DATE_FLAG,
i.  APCTRL_1099_FLAG,
i.  APCTRL_CHQ_XFLAG,
i.  APCTRL_CURR_YR,
i.  APCTRL_CURR_PER,
i.  APCTRL_STUB_LINES,
i.  APCTRL_RESTRICT_POST_FLAG,
i.  APCTRL_VERIFY_POVAR_AMT,
i.  APCTRL_ACCT_DFLT_STATE,
i.  APCTRL_TAX2_HLDBK_FLAG,
i.  APCTRL_CHQ_STUB_SORT_CODE,
i.  APCTRL_PRT_DEF,
i.  APCTRL_CHECK_MERGE_FLAG,
i.  APCTRL_SUMMARY_RETAIN_RLS_FLAG,
i.  APCTRL_APRV_REG_INV_FLAG,
i.  APCTRL_DEFAULT_TERM_CODE,
i.  APCTRL_FUTURE_POST_FLAG,
i.  APCTRL_DESC_REQD_FLAG,
i.  APCTRL_RECURR_VOU_PREFIX,
i.  APCTRL_RECURR_NEXT_SEQ_NUM,
i.  APCTRL_RECURR_LAST_BCH_NUM,
i.  APCTRL_RECURR_LAST_SEQ_NUM,
i.  APCTRL_PO_VAR_DEPT_CODE,
i.  APCTRL_PO_VAR_ACC_CODE,
i.  APCTRL_ALLOW_DUP_CHEQUE_FLAG,
i.  APCTRL_USE_JOB_BANK_ACCT_FLAG,
i.  APCTRL_CLOSE_0_PO_LINES_FLAG,
i.  APCTRL_VOUCHER_HOLD_FLAG,
i.  APCTRL_USE_VOU_ACC_FLAG,
i.  APCTRL_PPE_DEPT_CODE,
i.  APCTRL_PPE_ACC_CODE,
i.  APCTRL_DEFAULT_PAY_CODE,
i.  APCTRL_AUTO_CHECK_POST_FLAG,
i.  APCTRL_USE_CHQ_VOU_CODE_FLAG,
i.  APCTRL_INV_NUM_USED_WARN,
i.  APCTRL_CHECK_DUPL_VEN_AMT_FLAG,
i.  APCTRL_DUPL_VEN_AMOUNT,
i.  APCTRL_DUPL_VEN_AMT_MONTH,
i.  APCTRL_EFT_STUB_NAME,
i.  APCTRL_EFT_FILE_FORMAT,
i.  APCTRL_EFT_FILE_CODE,
i.  APCTRL_CHQ_ORDER_FLAG,
i.  APCTRL_VEN_ADD_REQD_FLAG,
i.  APCTRL_DIRECT_TAX_VOU_FLAG,
i.  APCTRL_ALLOCATE_ITEMS_IN_REG,
i.  APCTRL_PART_PAID_VOU_DFLT_STAT,
i.  APCTRL_RAISE_VAR_ERROR_FLAG,
i.  APCTRL_POP_CHQ_REL_DATE_FLAG,
i.  APCTRL_ALLOW_DATE_NOT_CURR_PER,
i.  APCTRL_VERIFY_SC_STRUCT_FLAG,
i.  APCTRL_TOTAL_PO_VARIANCE_AMT,
i.  APCTRL_TOTAL_PO_VARIANCE_PC,
i.  APCTRL_VARIANCE_ACCESS_FLAG,
i.  APCTRL_USE_PO_TERMS_FLAG,
i.  APCTRL_MULTIPLE_DIR_TAXES_FLAG,
i.  APCTRL_USE_PAY_WHEN_PAID_FLAG,
i.  APCTRL_PAY_WHEN_PAID_DAYS,
i.  APCTRL_PREDATED_CHECKS,
i.  APCTRL_BCH_TOTAL_FLAG,
i.  APCTRL_SEP_VOU_PER_JOB_FLAG,
i.  APCTRL_ALTERNATE_ADDRESS_EXIST,
i.  APCTRL_AUTO_DRAW_NUM_FLAG,
i.  APCTRL_COMPL_DATE_SENS,
i.  APCTRL_KEEP_FUTURE_DUE_DATE,
i.  APCTRL_INV_MRKT_PRC_BILL_RATE,
i.  APCTRL_MATRECEIPT_AUTONUM_FLAG,
i.  APCTRL_MATRECEIPT_NUM_MASK,
i.  APCTRL_SLER_DEPT_CODE,
i.  APCTRL_SLER_ACC_CODE,
i.  APCTRL_SLIR_DEPT_CODE,
i.  APCTRL_SLIR_ACC_CODE,
i.  APCTRL_CHECK_POST_DATE_FLAG,
--i.  --APCTRL__IU__CREATE_DATE,
--i.  --APCTRL__IU__CREATE_USER,
--i.  --APCTRL__IU__UPDATE_DATE,
--i.  --APCTRL__IU__UPDATE_USER,
i.  APCTRL_USE_PRELIEN_FLAG,
i.  APCTRL_GROUP_CHK_BY_JP_FLAG,
i.  APCTRL_PRELIEN_TYPE_CODE,
i.  APCTRL_SELPAY_USER_WARN_FLAG

);
end loop;
--commit;
select count(1) into v_cnt_conv from APCTRL@conv;
select count(1) into v_cnt_prod from APCTRL@prod;
if v_cnt_conv - v_cnt_prod = 0
then
dbms_output.put_line ('Number of records in PROD match with CONV for APCTRL table.');
else
dbms_output.put_line ('Number of records in PROD does not match with CONV for APCTRL table.');
Raise record_count_mismatch;
end if;
Select count(1) into v_cnt from DA.APCTRL@PROD where apctrl_comp_code not in ('ZZ');
dbms_output.put_line ('Inserted '||v_cnt||' records into APCTRL table, check and commit.');
EXCEPTION
WHEN record_count_mismatch
THEN
DBMS_OUTPUT.PUT_LINE ('There is a mismatch in PROD and CONV for this table.');
WHEN OTHERS 
THEN
DBMS_OUTPUT.PUT_LINE ('ERROR WHILE INSERTING INTO DA.APCTRL.');
DBMS_OUTPUT.PUT_LINE (SQLERRM);

end;
/ 