
declare

v_cnt      NUMBER;
v_cnt_conv NUMBER;
v_cnt_prod NUMBER;
record_count_mismatch exception;

begin
for i in
(
SELECT 
  JCCTRL_COMP_CODE,
  JCCTRL_WIP_DEPT_CODE,
  JCCTRL_WIP_ACC_CODE,
  JCCTRL_LTC_DEPT_CODE,
  JCCTRL_LTC_ACC_CODE,
  JCCTRL_CC_DEPT_CODE,
  JCCTRL_CC_ACC_CODE,
  JCCTRL_BILL_DEPT_CODE,
  JCCTRL_BILL_ACC_CODE,
  JCCTRL_LABB_DEPT_CODE,
  JCCTRL_LABB_ACC_CODE,
  JCCTRL_COST_METH_CODE,
  JCCTRL_PROJ_FINAL_CODE,
  JCCTRL_DFTCAT_SBCTR_CODE,
  JCCTRL_DFTCAT_LAB_CODE,
  JCCTRL_DFTCAT_MAT_CODE,
  JCCTRL_DFTCAT_EQP_CODE,
  JCCTRL_BAL_CALCULATE_CODE,
  JCCTRL_COMM_METH_CODE,
  JCCTRL_POST_CTRL_JOB_FLAG,
  JCCTRL_OVERHEAD_CAT_CODE,
  JCCTRL_OVERHEAD_DEPT_CODE,
  JCCTRL_OVERHEAD_ACC_CODE,
  JCCTRL_REVENUE_GEN_STATE,
  JCCTRL_UNBILLED_REV_DEPT_CODE,
  JCCTRL_UNBILLED_REV_ACC_CODE,
  JCCTRL_INDIRECT_JOURNAL_CODE,
  JCCTRL_MUTLI_OVHD_PC_FLAG,
  JCCTRL_BID_COST_CAT_CODE,
  JCCTRL_BID_COST_PHS_CODE,
  JCCTRL_JOB_AUTONUM_FLAG,
  JCCTRL_JOB_AUTONUM_MASK,
  JCCTRL_FEE_CAT_CODE,
  JCCTRL_JOB_BID_FLAG,
  JCCTRL_COST_TRANSFER_BID_FLAG,
  JCCTRL_USE_REV_FOR_FEE,
  JCCTRL_INV_PRT_NAME,
  JCCTRL_USE_PAY_BILL_RATE_FLAG,
  JCCTRL_USE_EQP_BILL_RATE_FLAG,
  JCCTRL_INVOICE_SERIES_CODE,
  JCCTRL_IB_CTRL_CAT_CODE,
  JCCTRL_IB_EXPENSE_CAT_CODE,
  JCCTRL_DEFAULT_IB_ALLOW_FLAG,
  JCCTRL_RESERVE_REV_DEPT_CODE,
  JCCTRL_RESERVE_REV_ACC_CODE,
  JCCTRL_DEFAULT_BILL_METHOD,
  JCCTRL_SINGLE_CAT_BUDG_FLAG,
  JCCTRL_BUDG_CAT_CODE,
  JCCTRL_PY_ADJ_JOUR_CODE,
  JCCTRL_AP_ADJ_JOUR_CODE,
  JCCTRL_REV_ADJ_JOUR_CODE,
  JCCTRL_JOB_DEPT_FLAG,
  JCCTRL_JOB_BILL_RATE_CODE_FLAG,
  JCCTRL_JOBPHS_MAX_REV_CAP_FLAG,
  JCCTRL_IMP_UPD_EST_FLAG,
  JCCTRL_CREATE_OVERHEAD_FLAG,
  JCCTRL_IB_CTRL_DEPT_FLAG,
  JCCTRL_IB_LIMIT_POST_FLAG,
  JCCTRL_IB_LIMIT_JOUR_CODE,
  JCCTRL_DEFAULT_WIP_SOURCE_CODE,
  JCCTRL_WIP_ADJ_DEPT_CODE,
  JCCTRL_WIP_ADJ_ACC_CODE,
  JCCTRL_AUTO_REVERSE_ACCRUAL,
  JCCTRL_DFLT_ALLOW_TRANS_FLAG,
  JCCTRL_WIP_ROLL_IN_SUBJOB_FLAG,
  JCCTRL_AUTO_EQP_LOC_FLAG,
  JCCTRL_EST_START_DATE_FLAG,
  JCCTRL_PM_MANDATORY_FLAG,
  JCCTRL_PM_SYNCH_FLAG,
  JCCTRL_JB_ADD_CODE_SYNCH_FLAG,
  JCCTRL_JB_DEFAULT_DEPT_FLAG,
  JCCTRL_JB_WORK_LOC_DFLT_FLAG,
  JCCTRL_WIP_ADJ_OVERRIDE_FLAG,
  JCCTRL_DETAIL_TPB_FLAG,
  JCCTRL_ADJUST_COMM_AMT_FLAG,
  JCCTRL_JOBPHS_WCB_REQD_FLAG,
  JCCTRL_PST_ADJ_ACC_CLSD_JOB,
  JCCTRL_IGNORE_SUBJOB_DEPT_FLAG,
  JCCTRL_ALLOW_DEPT_CHG_FLAG,
  JCCTRL_CURR_YR,
  JCCTRL_CURR_PER,
  JCCTRL_FUTURE_POST_FLAG,
  JCCTRL_PHS_BILLING_UNIT_FLAG,
  JCCTRL__IU__CREATE_DATE,
  JCCTRL__IU__CREATE_USER,
  JCCTRL__IU__UPDATE_DATE,
  JCCTRL__IU__UPDATE_USER,
  JCCTRL_DISREG_INACT_FLAG,
  JCCTRL_COPY_BID_PHASES,
  JCCTRL_FREEZE_ALSO_UNITS_FLAG,
  JCCTRL_CONT_FORECAST_YEAR,
  JCCTRL_CONT_FORECAST_PERIOD,
  JCCTRL_CONT_FRCST_ALW_FTR_FLAG,
  JCCTRL_WIP_REV_NOT_EXCEED_FLAG,
  JCCTRL_WIP_YR,
  JCCTRL_WIP_PER,
  JCCTRL_COPY_LAST_FCST_FLAG,
  JCCTRL_WIP_UNPOSTED_COST_PHASE,
  JCCTRL_WIP_UNPOSTED_COST_CAT,
  JCCTRL_WIP_UNPOSTED_COST_DEP,
  JCCTRL_WIP_UNPOSTED_COST_ACC,
  JCCTRL_WIP_UNPOSTED_REV_PHASE,
  JCCTRL_WIP_UNPOSTED_REV_CAT,
  JCCTRL_WIP_UNPOSTED_REV_DEP,
  JCCTRL_WIP_UNPOSTED_REV_ACC,
  JCCTRL_PY_OVHD_GROUP_FLAG,
  JCCTRL_COST_TO_COMPL_OVRD_FLG,
  JCCTRL_MS_FLAG,
  JCCTRL_WIP_PROJ_PROFIT_SOURCE,
  JCCTRL_PHS_CODE_MAX_LENGTH,
  JCCTRL_PHS_SEGMENT_STRUCTURE,
  JCCTRL_COPY_FCAST_NOTES_FLAG,
  JCCTRL_DONTAUT_CLALC_ER_ORIDE,
  JCCTRL_BILL_TBL_REV_FCAST_FLG,
  JCCTRL_MAXBILLAMT_INCL_UNP_FLG,
  JCCTRL_PHS_SEGM_FRST_FLAG,
  JCCTRL_PHS_SEGM_FRST_MASK
FROM DA.JCCTRL@CONV
WHERE jcctrl_comp_code NOT IN ('ZZ')
) loop
INSERT INTO DA.JCCTRL
(  
  JCCTRL_COMP_CODE,
  JCCTRL_WIP_DEPT_CODE,
  JCCTRL_WIP_ACC_CODE,
  JCCTRL_LTC_DEPT_CODE,
  JCCTRL_LTC_ACC_CODE,
  JCCTRL_CC_DEPT_CODE,
  JCCTRL_CC_ACC_CODE,
  JCCTRL_BILL_DEPT_CODE,
  JCCTRL_BILL_ACC_CODE,
  JCCTRL_LABB_DEPT_CODE,
  JCCTRL_LABB_ACC_CODE,
  JCCTRL_COST_METH_CODE,
  JCCTRL_PROJ_FINAL_CODE,
  JCCTRL_DFTCAT_SBCTR_CODE,
  JCCTRL_DFTCAT_LAB_CODE,
  JCCTRL_DFTCAT_MAT_CODE,
  JCCTRL_DFTCAT_EQP_CODE,
  JCCTRL_BAL_CALCULATE_CODE,
  JCCTRL_COMM_METH_CODE,
  JCCTRL_POST_CTRL_JOB_FLAG,
  JCCTRL_OVERHEAD_CAT_CODE,
  JCCTRL_OVERHEAD_DEPT_CODE,
  JCCTRL_OVERHEAD_ACC_CODE,
  JCCTRL_REVENUE_GEN_STATE,
  JCCTRL_UNBILLED_REV_DEPT_CODE,
  JCCTRL_UNBILLED_REV_ACC_CODE,
  JCCTRL_INDIRECT_JOURNAL_CODE,
  JCCTRL_MUTLI_OVHD_PC_FLAG,
  JCCTRL_BID_COST_CAT_CODE,
  JCCTRL_BID_COST_PHS_CODE,
  JCCTRL_JOB_AUTONUM_FLAG,
  JCCTRL_JOB_AUTONUM_MASK,
  JCCTRL_FEE_CAT_CODE,
  JCCTRL_JOB_BID_FLAG,
  JCCTRL_COST_TRANSFER_BID_FLAG,
  JCCTRL_USE_REV_FOR_FEE,
  JCCTRL_INV_PRT_NAME,
  JCCTRL_USE_PAY_BILL_RATE_FLAG,
  JCCTRL_USE_EQP_BILL_RATE_FLAG,
  JCCTRL_INVOICE_SERIES_CODE,
  JCCTRL_IB_CTRL_CAT_CODE,
  JCCTRL_IB_EXPENSE_CAT_CODE,
  JCCTRL_DEFAULT_IB_ALLOW_FLAG,
  JCCTRL_RESERVE_REV_DEPT_CODE,
  JCCTRL_RESERVE_REV_ACC_CODE,
  JCCTRL_DEFAULT_BILL_METHOD,
  JCCTRL_SINGLE_CAT_BUDG_FLAG,
  JCCTRL_BUDG_CAT_CODE,
  JCCTRL_PY_ADJ_JOUR_CODE,
  JCCTRL_AP_ADJ_JOUR_CODE,
  JCCTRL_REV_ADJ_JOUR_CODE,
  JCCTRL_JOB_DEPT_FLAG,
  JCCTRL_JOB_BILL_RATE_CODE_FLAG,
  JCCTRL_JOBPHS_MAX_REV_CAP_FLAG,
  JCCTRL_IMP_UPD_EST_FLAG,
  JCCTRL_CREATE_OVERHEAD_FLAG,
  JCCTRL_IB_CTRL_DEPT_FLAG,
  JCCTRL_IB_LIMIT_POST_FLAG,
  JCCTRL_IB_LIMIT_JOUR_CODE,
  JCCTRL_DEFAULT_WIP_SOURCE_CODE,
  JCCTRL_WIP_ADJ_DEPT_CODE,
  JCCTRL_WIP_ADJ_ACC_CODE,
  JCCTRL_AUTO_REVERSE_ACCRUAL,
  JCCTRL_DFLT_ALLOW_TRANS_FLAG,
  JCCTRL_WIP_ROLL_IN_SUBJOB_FLAG,
  JCCTRL_AUTO_EQP_LOC_FLAG,
  JCCTRL_EST_START_DATE_FLAG,
  JCCTRL_PM_MANDATORY_FLAG,
  JCCTRL_PM_SYNCH_FLAG,
  JCCTRL_JB_ADD_CODE_SYNCH_FLAG,
  JCCTRL_JB_DEFAULT_DEPT_FLAG,
  JCCTRL_JB_WORK_LOC_DFLT_FLAG,
  JCCTRL_WIP_ADJ_OVERRIDE_FLAG,
  JCCTRL_DETAIL_TPB_FLAG,
  JCCTRL_ADJUST_COMM_AMT_FLAG,
  JCCTRL_JOBPHS_WCB_REQD_FLAG,
  JCCTRL_PST_ADJ_ACC_CLSD_JOB,
  JCCTRL_IGNORE_SUBJOB_DEPT_FLAG,
  JCCTRL_ALLOW_DEPT_CHG_FLAG,
  JCCTRL_CURR_YR,
  JCCTRL_CURR_PER,
  JCCTRL_FUTURE_POST_FLAG,
  JCCTRL_PHS_BILLING_UNIT_FLAG,
  --JCCTRL__IU__CREATE_DATE,
  --JCCTRL__IU__CREATE_USER,
  --JCCTRL__IU__UPDATE_DATE,
  --JCCTRL__IU__UPDATE_USER,
  JCCTRL_DISREG_INACT_FLAG,
  JCCTRL_COPY_BID_PHASES,
  JCCTRL_FREEZE_ALSO_UNITS_FLAG,
  JCCTRL_CONT_FORECAST_YEAR,
  JCCTRL_CONT_FORECAST_PERIOD,
  JCCTRL_CONT_FRCST_ALW_FTR_FLAG,
  JCCTRL_WIP_REV_NOT_EXCEED_FLAG,
  JCCTRL_WIP_YR,
  JCCTRL_WIP_PER,
  JCCTRL_COPY_LAST_FCST_FLAG,
  JCCTRL_WIP_UNPOSTED_COST_PHASE,
  JCCTRL_WIP_UNPOSTED_COST_CAT,
  JCCTRL_WIP_UNPOSTED_COST_DEP,
  JCCTRL_WIP_UNPOSTED_COST_ACC,
  JCCTRL_WIP_UNPOSTED_REV_PHASE,
  JCCTRL_WIP_UNPOSTED_REV_CAT,
  JCCTRL_WIP_UNPOSTED_REV_DEP,
  JCCTRL_WIP_UNPOSTED_REV_ACC,
  JCCTRL_PY_OVHD_GROUP_FLAG,
  JCCTRL_COST_TO_COMPL_OVRD_FLG,
  JCCTRL_MS_FLAG,
  JCCTRL_WIP_PROJ_PROFIT_SOURCE,
  JCCTRL_PHS_CODE_MAX_LENGTH,
  JCCTRL_PHS_SEGMENT_STRUCTURE,
  JCCTRL_COPY_FCAST_NOTES_FLAG,
  JCCTRL_DONTAUT_CLALC_ER_ORIDE,
  JCCTRL_BILL_TBL_REV_FCAST_FLG,
  JCCTRL_MAXBILLAMT_INCL_UNP_FLG,
  JCCTRL_PHS_SEGM_FRST_FLAG,
  JCCTRL_PHS_SEGM_FRST_MASK
)
values
(
i.  JCCTRL_COMP_CODE,
i.  JCCTRL_WIP_DEPT_CODE,
i.  JCCTRL_WIP_ACC_CODE,
i.  JCCTRL_LTC_DEPT_CODE,
i.  JCCTRL_LTC_ACC_CODE,
i.  JCCTRL_CC_DEPT_CODE,
i.  JCCTRL_CC_ACC_CODE,
i.  JCCTRL_BILL_DEPT_CODE,
i.  JCCTRL_BILL_ACC_CODE,
i.  JCCTRL_LABB_DEPT_CODE,
i.  JCCTRL_LABB_ACC_CODE,
i.  JCCTRL_COST_METH_CODE,
i.  JCCTRL_PROJ_FINAL_CODE,
i.  JCCTRL_DFTCAT_SBCTR_CODE,
i.  JCCTRL_DFTCAT_LAB_CODE,
i.  JCCTRL_DFTCAT_MAT_CODE,
i.  JCCTRL_DFTCAT_EQP_CODE,
i.  JCCTRL_BAL_CALCULATE_CODE,
i.  JCCTRL_COMM_METH_CODE,
i.  JCCTRL_POST_CTRL_JOB_FLAG,
i.  JCCTRL_OVERHEAD_CAT_CODE,
i.  JCCTRL_OVERHEAD_DEPT_CODE,
i.  JCCTRL_OVERHEAD_ACC_CODE,
i.  JCCTRL_REVENUE_GEN_STATE,
i.  JCCTRL_UNBILLED_REV_DEPT_CODE,
i.  JCCTRL_UNBILLED_REV_ACC_CODE,
i.  JCCTRL_INDIRECT_JOURNAL_CODE,
i.  JCCTRL_MUTLI_OVHD_PC_FLAG,
i.  JCCTRL_BID_COST_CAT_CODE,
i.  JCCTRL_BID_COST_PHS_CODE,
i.  JCCTRL_JOB_AUTONUM_FLAG,
i.  JCCTRL_JOB_AUTONUM_MASK,
i.  JCCTRL_FEE_CAT_CODE,
i.  JCCTRL_JOB_BID_FLAG,
i.  JCCTRL_COST_TRANSFER_BID_FLAG,
i.  JCCTRL_USE_REV_FOR_FEE,
i.  JCCTRL_INV_PRT_NAME,
i.  JCCTRL_USE_PAY_BILL_RATE_FLAG,
i.  JCCTRL_USE_EQP_BILL_RATE_FLAG,
i.  JCCTRL_INVOICE_SERIES_CODE,
i.  JCCTRL_IB_CTRL_CAT_CODE,
i.  JCCTRL_IB_EXPENSE_CAT_CODE,
i.  JCCTRL_DEFAULT_IB_ALLOW_FLAG,
i.  JCCTRL_RESERVE_REV_DEPT_CODE,
i.  JCCTRL_RESERVE_REV_ACC_CODE,
i.  JCCTRL_DEFAULT_BILL_METHOD,
i.  JCCTRL_SINGLE_CAT_BUDG_FLAG,
i.  JCCTRL_BUDG_CAT_CODE,
i.  JCCTRL_PY_ADJ_JOUR_CODE,
i.  JCCTRL_AP_ADJ_JOUR_CODE,
i.  JCCTRL_REV_ADJ_JOUR_CODE,
i.  JCCTRL_JOB_DEPT_FLAG,
i.  JCCTRL_JOB_BILL_RATE_CODE_FLAG,
i.  JCCTRL_JOBPHS_MAX_REV_CAP_FLAG,
i.  JCCTRL_IMP_UPD_EST_FLAG,
i.  JCCTRL_CREATE_OVERHEAD_FLAG,
i.  JCCTRL_IB_CTRL_DEPT_FLAG,
i.  JCCTRL_IB_LIMIT_POST_FLAG,
i.  JCCTRL_IB_LIMIT_JOUR_CODE,
i.  JCCTRL_DEFAULT_WIP_SOURCE_CODE,
i.  JCCTRL_WIP_ADJ_DEPT_CODE,
i.  JCCTRL_WIP_ADJ_ACC_CODE,
i.  JCCTRL_AUTO_REVERSE_ACCRUAL,
i.  JCCTRL_DFLT_ALLOW_TRANS_FLAG,
i.  JCCTRL_WIP_ROLL_IN_SUBJOB_FLAG,
i.  JCCTRL_AUTO_EQP_LOC_FLAG,
i.  JCCTRL_EST_START_DATE_FLAG,
i.  JCCTRL_PM_MANDATORY_FLAG,
i.  JCCTRL_PM_SYNCH_FLAG,
i.  JCCTRL_JB_ADD_CODE_SYNCH_FLAG,
i.  JCCTRL_JB_DEFAULT_DEPT_FLAG,
i.  JCCTRL_JB_WORK_LOC_DFLT_FLAG,
i.  JCCTRL_WIP_ADJ_OVERRIDE_FLAG,
i.  JCCTRL_DETAIL_TPB_FLAG,
i.  JCCTRL_ADJUST_COMM_AMT_FLAG,
i.  JCCTRL_JOBPHS_WCB_REQD_FLAG,
i.  JCCTRL_PST_ADJ_ACC_CLSD_JOB,
i.  JCCTRL_IGNORE_SUBJOB_DEPT_FLAG,
i.  JCCTRL_ALLOW_DEPT_CHG_FLAG,
i.  JCCTRL_CURR_YR,
i.  JCCTRL_CURR_PER,
i.  JCCTRL_FUTURE_POST_FLAG,
i.  JCCTRL_PHS_BILLING_UNIT_FLAG,
--i.  --JCCTRL__IU__CREATE_DATE,
--i.  --JCCTRL__IU__CREATE_USER,
--i.  --JCCTRL__IU__UPDATE_DATE,
--i.  --JCCTRL__IU__UPDATE_USER,
i.  JCCTRL_DISREG_INACT_FLAG,
i.  JCCTRL_COPY_BID_PHASES,
i.  JCCTRL_FREEZE_ALSO_UNITS_FLAG,
i.  JCCTRL_CONT_FORECAST_YEAR,
i.  JCCTRL_CONT_FORECAST_PERIOD,
i.  JCCTRL_CONT_FRCST_ALW_FTR_FLAG,
i.  JCCTRL_WIP_REV_NOT_EXCEED_FLAG,
i.  JCCTRL_WIP_YR,
i.  JCCTRL_WIP_PER,
i.  JCCTRL_COPY_LAST_FCST_FLAG,
i.  JCCTRL_WIP_UNPOSTED_COST_PHASE,
i.  JCCTRL_WIP_UNPOSTED_COST_CAT,
i.  JCCTRL_WIP_UNPOSTED_COST_DEP,
i.  JCCTRL_WIP_UNPOSTED_COST_ACC,
i.  JCCTRL_WIP_UNPOSTED_REV_PHASE,
i.  JCCTRL_WIP_UNPOSTED_REV_CAT,
i.  JCCTRL_WIP_UNPOSTED_REV_DEP,
i.  JCCTRL_WIP_UNPOSTED_REV_ACC,
i.  JCCTRL_PY_OVHD_GROUP_FLAG,
i.  JCCTRL_COST_TO_COMPL_OVRD_FLG,
i.  JCCTRL_MS_FLAG,
i.  JCCTRL_WIP_PROJ_PROFIT_SOURCE,
i.  JCCTRL_PHS_CODE_MAX_LENGTH,
i.  JCCTRL_PHS_SEGMENT_STRUCTURE,
i.  JCCTRL_COPY_FCAST_NOTES_FLAG,
i.  JCCTRL_DONTAUT_CLALC_ER_ORIDE,
i.  JCCTRL_BILL_TBL_REV_FCAST_FLG,
i.  JCCTRL_MAXBILLAMT_INCL_UNP_FLG,
i.  JCCTRL_PHS_SEGM_FRST_FLAG,
i.  JCCTRL_PHS_SEGM_FRST_MASK
);
end loop;
--commit;
select count(1) into v_cnt_conv from JCCTRL@conv;
select count(1) into v_cnt_prod from JCCTRL@prod;
if v_cnt_conv - v_cnt_prod = 0
then
dbms_output.put_line ('Number of records in PROD match with CONV for JCCTRL table.');
else
dbms_output.put_line ('Number of records in PROD does not match with CONV for JCCTRL table.');
Raise record_count_mismatch;
end if;
Select count(1) into v_cnt from DA.JCCTRL@PROD where jcctrl_comp_code NOT IN ('ZZ');
dbms_output.put_line ('Inserted '||v_cnt||' records into JCCTRL table, check and commit.');
EXCEPTION
WHEN record_count_mismatch
THEN
DBMS_OUTPUT.PUT_LINE ('There is a mismatch in PROD and CONV for this table.');
WHEN OTHERS 
THEN
DBMS_OUTPUT.PUT_LINE ('ERROR WHILE INSERTING INTO DA.JCCTRL.');
DBMS_OUTPUT.PUT_LINE (SQLERRM);

end;
/ 