


declare

v_cnt      NUMBER;
v_cnt_conv NUMBER;
v_cnt_prod NUMBER;
record_count_mismatch exception;

begin
for i in
(
SELECT COMP_CODE,
  COMP_NAME,
  COMP_ADD1,
  COMP_ADD2,
  COMP_ADD3,
  COMP_REGION_CODE,
  COMP_COUNTRY,
  COMP_POSTAL_CODE,
  COMP_PHONE_COUNTRY_CODE,
  COMP_PHONE_AREA_CODE,
  COMP_PHONE_NUM,
  COMP_FAX_COUNTRY_CODE,
  COMP_FAX_AREA_CODE,
  COMP_FAX_NUM,
  COMP_TELEX_NUM,
  COMP_CABLE_NUM,
  COMP_TERR_CODE,
  COMP_PER_NUM,
  COMP_CURR_PER,
  COMP_FISCAL_YR,
  COMP_CURR_CODE,
  COMP_DEPT_CODE,
  COMP_ARCH_DATE,
  COMP_TAX_CODE,
  COMP_COMPOUND_GST_CODE,
  COMP_CALC_START_DATE,
  COMP_CALC_END_DATE,
  COMP_IC_DEPT_CODE,
  COMP_IC_ACC_CODE,
  COMP_CONSCHART_CODE,
  COMP_CONSCHART_TYPE_CODE,
  COMP_ACC_BY_COMP_FLAG,
  COMP_ACC_BY_DEPT_FLAG,
  COMP_INTINT_CODE,
  COMP_MOCRR_CODE,
  COMP_FED_TAX1_CODE,
  COMP_FED_TAX2_CODE,
  COMP_CK_DIGIT_CODE,
  COMP_TYPE_CODE,
  COMP_EMP_NUM,
  COMP_CTRL_CODE,
  COMP_OWNERSHIP_PC,
  COMP_ESTABLISH_DATE,
  COMP_TAX_DIST,
  COMP_VAT_REG_NUM,
  COMP_OF_GL_FLAG,
  COMP_OF_GL_SET_OF_BOOKS_ID,
  COMP_OF_GL_ID_FLEX_CODE,
  COMP_OF_GL_ID_FLEX_NUM,
  COMP_OF_GL_SEGMENTS,
  COMP_OF_GL_VALUES,
  COMP_USE_TAC_FLAG,
  COMP_CONS_CODE,
  COMP_DIST_GL_COMP_CODE,
  COMP_DIST_GL_DEPT_CODE,
  COMP_DIST_GL_LOG_DAYS_NUM,
  COMP_DIST_GL_FLAG,
  COMP_INT_CLR_DEPT_CODE,
  COMP_LEGAL_NAME,
  COMP_LOGO_FILE,
  COMP_WEB_ADD,
  COMP_EMAIL_ADD,
  COMP_LOGO_FILE_ON_WEB,
  COMP_OBJECT_ORASEQ--,
  --COMP__IU__CREATE_DATE,
  --COMP__IU__CREATE_USER,
  --COMP__IU__UPDATE_DATE,
  --COMP__IU__UPDATE_USER
FROM DA.COMPANY@CONV
WHERE COMP_CODE NOT IN ('ZZ')
) loop
INSERT INTO DA.COMPANY
(COMP_CODE,
  COMP_NAME,
  COMP_ADD1,
  COMP_ADD2,
  COMP_ADD3,
  COMP_region_CODE,
  COMP_COUNTRY,
  COMP_POSTAL_CODE,
  COMP_PHONE_COUNTRY_CODE,
  COMP_PHONE_AREA_CODE,
  COMP_PHONE_NUM,
  COMP_FAX_COUNTRY_CODE,
  COMP_FAX_AREA_CODE,
  COMP_FAX_NUM,
  COMP_TELEX_NUM,
  COMP_CABLE_NUM,
  COMP_TERR_CODE,
  COMP_PER_NUM,
  COMP_CURR_PER,
  COMP_FISCAL_YR,
  COMP_CURR_CODE,
  COMP_DEPT_CODE,
  COMP_ARCH_DATE,
  COMP_TAX_CODE,
  COMP_COMPOUND_GST_CODE,
  COMP_CALC_START_DATE,
  COMP_CALC_END_DATE,
  COMP_IC_DEPT_CODE,
  COMP_IC_ACC_CODE,
  COMP_CONSCHART_CODE,
  COMP_CONSCHART_TYPE_CODE,
  COMP_ACC_BY_COMP_FLAG,
  COMP_ACC_BY_DEPT_FLAG,
  COMP_INTINT_CODE,
  COMP_MOCRR_CODE,
  COMP_FED_TAX1_CODE,
  COMP_FED_TAX2_CODE,
  COMP_CK_DIGIT_CODE,
  COMP_TYPE_CODE,
  COMP_EMP_NUM,
  COMP_CTRL_CODE,
  COMP_OWNERSHIP_PC,
  COMP_ESTABLISH_DATE,
  COMP_TAX_DIST,
  COMP_VAT_REG_NUM,
  COMP_OF_GL_FLAG,
  COMP_OF_GL_SET_OF_BOOKS_ID,
  COMP_OF_GL_ID_FLEX_CODE,
  COMP_OF_GL_ID_FLEX_NUM,
  COMP_OF_GL_SEGMENTS,
  COMP_OF_GL_VALUES,
  COMP_USE_TAC_FLAG,
  COMP_CONS_CODE,
  COMP_DIST_GL_COMP_CODE,
  COMP_DIST_GL_DEPT_CODE,
  COMP_DIST_GL_LOG_DAYS_NUM,
  COMP_DIST_GL_FLAG,
  COMP_INT_CLR_DEPT_CODE,
  COMP_LEGAL_NAME,
  COMP_LOGO_FILE,
  COMP_WEB_ADD,
  COMP_EMAIL_ADD,
  COMP_LOGO_FILE_ON_WEB,
  COMP_OBJECT_ORASEQ--,
  --COMP__IU__CREATE_DATE,
  --COMP__IU__CREATE_USER,
  --COMP__IU__UPDATE_DATE,
  --COMP__IU__UPDATE_USER
)
values
(
i.  COMP_CODE,
i.  COMP_NAME,
i.  COMP_ADD1,
i.  COMP_ADD2,
i.  COMP_ADD3,
i.  COMP_region_CODE,
i.  COMP_COUNTRY,
i.  COMP_POSTAL_CODE,
i.  COMP_PHONE_COUNTRY_CODE,
i.  COMP_PHONE_AREA_CODE,
i.  COMP_PHONE_NUM,
i.  COMP_FAX_COUNTRY_CODE,
i.  COMP_FAX_AREA_CODE,
i.  COMP_FAX_NUM,
i.  COMP_TELEX_NUM,
i.  COMP_CABLE_NUM,
i.  COMP_TERR_CODE,
i.  COMP_PER_NUM,
i.  COMP_CURR_PER,
i.  COMP_FISCAL_YR,
i.  COMP_CURR_CODE,
i.  COMP_DEPT_CODE,
i.  COMP_ARCH_DATE,
i.  COMP_TAX_CODE,
i.  COMP_COMPOUND_GST_CODE,
i.  COMP_CALC_START_DATE,
i.  COMP_CALC_END_DATE,
i.  COMP_IC_DEPT_CODE,
i.  COMP_IC_ACC_CODE,
i.  COMP_CONSCHART_CODE,
i.  COMP_CONSCHART_TYPE_CODE,
i.  COMP_ACC_BY_COMP_FLAG,
i.  COMP_ACC_BY_DEPT_FLAG,
i.  COMP_INTINT_CODE,
i.  COMP_MOCRR_CODE,
i.  COMP_FED_TAX1_CODE,
i.  COMP_FED_TAX2_CODE,
i.  COMP_CK_DIGIT_CODE,
i.  COMP_TYPE_CODE,
i.  COMP_EMP_NUM,
i.  COMP_CTRL_CODE,
i.  COMP_OWNERSHIP_PC,
i.  COMP_ESTABLISH_DATE,
i.  COMP_TAX_DIST,
i.  COMP_VAT_REG_NUM,
i.  COMP_OF_GL_FLAG,
i.  COMP_OF_GL_SET_OF_BOOKS_ID,
i.  COMP_OF_GL_ID_FLEX_CODE,
i.  COMP_OF_GL_ID_FLEX_NUM,
i.  COMP_OF_GL_SEGMENTS,
i.  COMP_OF_GL_VALUES,
i.  COMP_USE_TAC_FLAG,
i.  COMP_CONS_CODE,
i.  COMP_DIST_GL_COMP_CODE,
i.  COMP_DIST_GL_DEPT_CODE,
i.  COMP_DIST_GL_LOG_DAYS_NUM,
i.  COMP_DIST_GL_FLAG,
i.  COMP_INT_CLR_DEPT_CODE,
i.  COMP_LEGAL_NAME,
i.  COMP_LOGO_FILE,
i.  COMP_WEB_ADD,
i.  COMP_EMAIL_ADD,
i.  COMP_LOGO_FILE_ON_WEB,
i.  COMP_OBJECT_ORASEQ--,
--i.  COMP__IU__CREATE_DATE,
--i.  COMP__IU__CREATE_USER,
--i.  COMP__IU__UPDATE_DATE,
--i.  COMP__IU__UPDATE_USER
);
end loop;
--commit;
select count(1) into v_cnt_conv from company@conv;
select count(1) into v_cnt_prod from company@prod;
if v_cnt_conv - v_cnt_prod = 0
then
dbms_output.put_line ('Number of records in PROD match with CONV for company table.');
else
dbms_output.put_line ('Number of records in PROD does not match with CONV for company table.');
Raise record_count_mismatch;
end if;
Select count(1) into v_cnt from DA.company@PROD where COMP_CODE NOT IN ('ZZ');
dbms_output.put_line ('Inserted '||v_cnt||' records into COMPANY table, check and commit.');
EXCEPTION
WHEN record_count_mismatch
THEN
DBMS_OUTPUT.PUT_LINE ('There is a mismatch in PROD and CONV for this table.');
WHEN OTHERS 
THEN
DBMS_OUTPUT.PUT_LINE ('ERROR WHILE INSERTING INTO DA.company.');
DBMS_OUTPUT.PUT_LINE (SQLERRM);

end;
/ 