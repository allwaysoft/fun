
declare

v_cnt      NUMBER;
v_cnt_conv NUMBER;
v_cnt_prod NUMBER;
record_count_mismatch exception;

begin
for i in
(
SELECT 
  ARCTRL_COMP_CODE,
  ARCTRL_AGE_NUM,
  ARCTRL_MAX_WO_AMT,
  ARCTRL_STMT_DATE,
  ARCTRL_LAST_STMT_DATE,
  ARCTRL_IFIN_DATE,
  ARCTRL_AR_AGE_TYPE,
  ARCTRL_INT_AGE_TYPE,
  ARCTRL_AR_JOUR_CODE,
  ARCTRL_CR_JOUR_CODE,
  ARCTRL_FC_JOUR_CODE,
  ARCTRL_ORDER_BY_CODE,
  ARCTRL_DEDUCT_CODE,
  ARCTRL_ADD_CODE,
  ARCTRL_MIN_AMT,
  ARCTRL_OWING_CODE,
  ARCTRL_DPST_CODE,
  ARCTRL_COMM_CODE,
  ARCTRL_CREATE_CODE,
  ARCTRL_TAX_DISC_CODE,
  ARCTRL_FRT_DISC_CODE,
  ARCTRL_INS_DISC_CODE,
  ARCTRL_MISC_DISC_CODE,
  ARCTRL_NET_CODE,
  ARCTRL_STMT_NAME,
  ARCTRL_REP1_NAME,
  ARCTRL_FFINV_NAME,
  ARCTRL_STMT_PRT_TYPE,
  ARCTRL_STMT_LINES,
  ARCTRL_AR_DEPT_CODE,
  ARCTRL_AR_ACC_CODE,
  ARCTRL_FC_CR_DEPT_CODE,
  ARCTRL_FC_CR_ACC_CODE,
  ARCTRL_FC_DR_DEPT_CODE,
  ARCTRL_FC_DR_ACC_CODE,
  ARCTRL_SLS_DEPT_CODE,
  ARCTRL_SLS_ACC_CODE,
  ARCTRL_MISC_DEPT_CODE,
  ARCTRL_MISC_ACC_CODE,
  ARCTRL_FRT_DEPT_CODE,
  ARCTRL_FRT_ACC_CODE,
  ARCTRL_INS_DEPT_CODE,
  ARCTRL_INS_ACC_CODE,
  ARCTRL_HLDBK_DEPT_CODE,
  ARCTRL_HLDBK_ACC_CODE,
  ARCTRL_CASH_DEPT_CODE,
  ARCTRL_CASH_ACC_CODE,
  ARCTRL_CR_CASH_DEPT_CODE,
  ARCTRL_CR_CASH_ACC_CODE,
  ARCTRL_DISC_DEPT_CODE,
  ARCTRL_DISC_ACC_CODE,
  ARCTRL_WO_DEPT_CODE,
  ARCTRL_WO_ACC_CODE,
  ARCTRL_ALLOW_DEPT_CODE,
  ARCTRL_ALLOW_ACC_CODE,
  ARCTRL_DPST_DEPT_CODE,
  ARCTRL_DPST_ACC_CODE,
  ARCTRL_CURR_FLUC_DEPT_CODE,
  ARCTRL_CURR_FLUC_ACC_CODE,
  ARCTRL_FCSUM_CODE,
  ARCTRL_HLDBK_TYPE_CODE,
  ARCTRL_SHPLNE_CODE,
  ARCTRL_DUNN_CODE,
  ARCTRL_COLL_CODE,
  ARCTRL_SMAN1_CODE,
  ARCTRL_SMAN2_CODE,
  ARCTRL_SMAN3_CODE,
  ARCTRL_TAXED_CODE,
  ARCTRL_TAX1_CODE,
  ARCTRL_TAX2_CODE,
  ARCTRL_TAX3_CODE,
  ARCTRL_CURR_CODE,
  ARCTRL_SDISC_CODE,
  ARCTRL_CR_LIMIT_AMT,
  ARCTRL_SEQ_CODE,
  ARCTRL_H_CODE,
  ARCTRL_CUSTCL_CODE,
  ARCTRL_CUST_TERM_CODE,
  ARCTRL_CUST_CHRG_CODE,
  ARCTRL_TERR_CODE,
  ARCTRL_INV_PRT_NUM,
  ARCTRL_COUNTRY,
  ARCTRL_PAY_H_NUM,
  ARCTRL_INV_H_NUM,
  ARCTRL_PSTALLBCH_CODE,
  ARCTRL_TICKET_CODE,
  ARCTRL_AGING_METHOD_FLAG,
  ARCTRL_CUST_DUNNING_FLAG,
  ARCTRL_DUNNING_WIDTH_NUM,
  ARCTRL_DUNNING_LENGTH_NUM,
  ARCTRL_RESTRICT_POST_FLAG,
  ARCTRL_CURR_YR,
  ARCTRL_CURR_PER,
  ARCTRL_BCH_TOTAL_FLAG,
  ARCTRL_CUST_NAME_UPPER_FLAG,
  ARCTRL_CUST_ADDR_UPPER_FLAG,
  ARCTRL_WO_MAX_PERCENT,
  ARCTRL_WO_MAX_AMT,
  ARCTRL_MAX_WO_PERCENT,
  ARCTRL_TAX_WO_DEPT_CODE,
  ARCTRL_TAX_WO_ACC_CODE,
  ARCTRL_ALLOW_INV_OVERPAY_FLAG,
  ARCTRL_DISC_ALWAYS_DISP_FLAG,
  ARCTRL_DEFAULT_TERM_CODE,
  ARCTRL_INV_SERIES_FLAG,
  ARCTRL_DEFAULT_AR_DEPT_FLAG,
  ARCTRL_BANK_CODE,
  ARCTRL_EXCHG_RATE_TYPE,
  ARCTRL_INV_SER_CODE,
  ARCTRL_MAX_PRICE_CHG_PC,
  ARCTRL_TAXES_NUM,
  ARCTRL_DAYS_TO_PAY_CUTOFF_DAYS,
  ARCTRL_LOCKBOX_FILE_PATH,
  ARCTRL_LOCKBOX_FILE_PATTERN,
  ARCTRL_MAX_AUTO_CHQ_WO_AMOUNT,
  ARCTRL_AUTO_WOFF_CODE,
  ARCTRL_CHRGBACK_WOFF_COPIES,
  ARCTRL_LOGO_FILE,
  ARCTRL_DEFAULT_PAY_TYPE_CODE,
  ARCTRL_CASH_RCT_CUST_CODE,
  ARCTRL_DFLT_CORP_ADD_CODE,
  ARCTRL_RETAIN_CREDIT_TAX1_FLAG,
  ARCTRL_ALLOW_DATE_NOT_CURR_PER,
  ARCTRL_POST_PRIOR_DEPOSIT_FLAG,
  ARCTRL_POST_FUTURE_FLAG,
  ARCTRL_CUST_COLL_CODE,
  ARCTRL_DISREG_INACT_FLAG,
  ARCTRL_CASH_RCT_CASH_ACC_FLAG,
--  ARCTRL__IU__CREATE_DATE,
--  ARCTRL__IU__CREATE_USER,
--  ARCTRL__IU__UPDATE_DATE,
--  ARCTRL__IU__UPDATE_USER,
  ARCTRL_FOFFI_CASH_RCT_FLAG,
  ARCTRL_CALC_TAX_ON_FLAG,
  ARCTRL_SYNC_SELF_SUB_INVOICE
FROM DA.ARCTRL@CONV
WHERE arctrl_comp_code not in ('ZZ')
) loop
INSERT INTO DA.ARCTRL
(  
  ARCTRL_COMP_CODE,
  ARCTRL_AGE_NUM,
  ARCTRL_MAX_WO_AMT,
  ARCTRL_STMT_DATE,
  ARCTRL_LAST_STMT_DATE,
  ARCTRL_IFIN_DATE,
  ARCTRL_AR_AGE_TYPE,
  ARCTRL_INT_AGE_TYPE,
  ARCTRL_AR_JOUR_CODE,
  ARCTRL_CR_JOUR_CODE,
  ARCTRL_FC_JOUR_CODE,
  ARCTRL_ORDER_BY_CODE,
  ARCTRL_DEDUCT_CODE,
  ARCTRL_ADD_CODE,
  ARCTRL_MIN_AMT,
  ARCTRL_OWING_CODE,
  ARCTRL_DPST_CODE,
  ARCTRL_COMM_CODE,
  ARCTRL_CREATE_CODE,
  ARCTRL_TAX_DISC_CODE,
  ARCTRL_FRT_DISC_CODE,
  ARCTRL_INS_DISC_CODE,
  ARCTRL_MISC_DISC_CODE,
  ARCTRL_NET_CODE,
  ARCTRL_STMT_NAME,
  ARCTRL_REP1_NAME,
  ARCTRL_FFINV_NAME,
  ARCTRL_STMT_PRT_TYPE,
  ARCTRL_STMT_LINES,
  ARCTRL_AR_DEPT_CODE,
  ARCTRL_AR_ACC_CODE,
  ARCTRL_FC_CR_DEPT_CODE,
  ARCTRL_FC_CR_ACC_CODE,
  ARCTRL_FC_DR_DEPT_CODE,
  ARCTRL_FC_DR_ACC_CODE,
  ARCTRL_SLS_DEPT_CODE,
  ARCTRL_SLS_ACC_CODE,
  ARCTRL_MISC_DEPT_CODE,
  ARCTRL_MISC_ACC_CODE,
  ARCTRL_FRT_DEPT_CODE,
  ARCTRL_FRT_ACC_CODE,
  ARCTRL_INS_DEPT_CODE,
  ARCTRL_INS_ACC_CODE,
  ARCTRL_HLDBK_DEPT_CODE,
  ARCTRL_HLDBK_ACC_CODE,
  ARCTRL_CASH_DEPT_CODE,
  ARCTRL_CASH_ACC_CODE,
  ARCTRL_CR_CASH_DEPT_CODE,
  ARCTRL_CR_CASH_ACC_CODE,
  ARCTRL_DISC_DEPT_CODE,
  ARCTRL_DISC_ACC_CODE,
  ARCTRL_WO_DEPT_CODE,
  ARCTRL_WO_ACC_CODE,
  ARCTRL_ALLOW_DEPT_CODE,
  ARCTRL_ALLOW_ACC_CODE,
  ARCTRL_DPST_DEPT_CODE,
  ARCTRL_DPST_ACC_CODE,
  ARCTRL_CURR_FLUC_DEPT_CODE,
  ARCTRL_CURR_FLUC_ACC_CODE,
  ARCTRL_FCSUM_CODE,
  ARCTRL_HLDBK_TYPE_CODE,
  ARCTRL_SHPLNE_CODE,
  ARCTRL_DUNN_CODE,
  ARCTRL_COLL_CODE,
  ARCTRL_SMAN1_CODE,
  ARCTRL_SMAN2_CODE,
  ARCTRL_SMAN3_CODE,
  ARCTRL_TAXED_CODE,
  ARCTRL_TAX1_CODE,
  ARCTRL_TAX2_CODE,
  ARCTRL_TAX3_CODE,
  ARCTRL_CURR_CODE,
  ARCTRL_SDISC_CODE,
  ARCTRL_CR_LIMIT_AMT,
  ARCTRL_SEQ_CODE,
  ARCTRL_H_CODE,
  ARCTRL_CUSTCL_CODE,
  ARCTRL_CUST_TERM_CODE,
  ARCTRL_CUST_CHRG_CODE,
  ARCTRL_TERR_CODE,
  ARCTRL_INV_PRT_NUM,
  ARCTRL_COUNTRY,
  ARCTRL_PAY_H_NUM,
  ARCTRL_INV_H_NUM,
  ARCTRL_PSTALLBCH_CODE,
  ARCTRL_TICKET_CODE,
  ARCTRL_AGING_METHOD_FLAG,
  ARCTRL_CUST_DUNNING_FLAG,
  ARCTRL_DUNNING_WIDTH_NUM,
  ARCTRL_DUNNING_LENGTH_NUM,
  ARCTRL_RESTRICT_POST_FLAG,
  ARCTRL_CURR_YR,
  ARCTRL_CURR_PER,
  ARCTRL_BCH_TOTAL_FLAG,
  ARCTRL_CUST_NAME_UPPER_FLAG,
  ARCTRL_CUST_ADDR_UPPER_FLAG,
  ARCTRL_WO_MAX_PERCENT,
  ARCTRL_WO_MAX_AMT,
  ARCTRL_MAX_WO_PERCENT,
  ARCTRL_TAX_WO_DEPT_CODE,
  ARCTRL_TAX_WO_ACC_CODE,
  ARCTRL_ALLOW_INV_OVERPAY_FLAG,
  ARCTRL_DISC_ALWAYS_DISP_FLAG,
  ARCTRL_DEFAULT_TERM_CODE,
  ARCTRL_INV_SERIES_FLAG,
  ARCTRL_DEFAULT_AR_DEPT_FLAG,
  ARCTRL_BANK_CODE,
  ARCTRL_EXCHG_RATE_TYPE,
  ARCTRL_INV_SER_CODE,
  ARCTRL_MAX_PRICE_CHG_PC,
  ARCTRL_TAXES_NUM,
  ARCTRL_DAYS_TO_PAY_CUTOFF_DAYS,
  ARCTRL_LOCKBOX_FILE_PATH,
  ARCTRL_LOCKBOX_FILE_PATTERN,
  ARCTRL_MAX_AUTO_CHQ_WO_AMOUNT,
  ARCTRL_AUTO_WOFF_CODE,
  ARCTRL_CHRGBACK_WOFF_COPIES,
  ARCTRL_LOGO_FILE,
  ARCTRL_DEFAULT_PAY_TYPE_CODE,
  ARCTRL_CASH_RCT_CUST_CODE,
  ARCTRL_DFLT_CORP_ADD_CODE,
  ARCTRL_RETAIN_CREDIT_TAX1_FLAG,
  ARCTRL_ALLOW_DATE_NOT_CURR_PER,
  ARCTRL_POST_PRIOR_DEPOSIT_FLAG,
  ARCTRL_POST_FUTURE_FLAG,
  ARCTRL_CUST_COLL_CODE,
  ARCTRL_DISREG_INACT_FLAG,
  ARCTRL_CASH_RCT_CASH_ACC_FLAG,
--  ARCTRL__IU__CREATE_DATE,
--  ARCTRL__IU__CREATE_USER,
--  ARCTRL__IU__UPDATE_DATE,
--  ARCTRL__IU__UPDATE_USER,
  ARCTRL_FOFFI_CASH_RCT_FLAG,
  ARCTRL_CALC_TAX_ON_FLAG,
  ARCTRL_SYNC_SELF_SUB_INVOICE
)
values
(
i.  ARCTRL_COMP_CODE,
i.  ARCTRL_AGE_NUM,
i.  ARCTRL_MAX_WO_AMT,
i.  ARCTRL_STMT_DATE,
i.  ARCTRL_LAST_STMT_DATE,
i.  ARCTRL_IFIN_DATE,
i.  ARCTRL_AR_AGE_TYPE,
i.  ARCTRL_INT_AGE_TYPE,
i.  ARCTRL_AR_JOUR_CODE,
i.  ARCTRL_CR_JOUR_CODE,
i.  ARCTRL_FC_JOUR_CODE,
i.  ARCTRL_ORDER_BY_CODE,
i.  ARCTRL_DEDUCT_CODE,
i.  ARCTRL_ADD_CODE,
i.  ARCTRL_MIN_AMT,
i.  ARCTRL_OWING_CODE,
i.  ARCTRL_DPST_CODE,
i.  ARCTRL_COMM_CODE,
i.  ARCTRL_CREATE_CODE,
i.  ARCTRL_TAX_DISC_CODE,
i.  ARCTRL_FRT_DISC_CODE,
i.  ARCTRL_INS_DISC_CODE,
i.  ARCTRL_MISC_DISC_CODE,
i.  ARCTRL_NET_CODE,
i.  ARCTRL_STMT_NAME,
i.  ARCTRL_REP1_NAME,
i.  ARCTRL_FFINV_NAME,
i.  ARCTRL_STMT_PRT_TYPE,
i.  ARCTRL_STMT_LINES,
i.  ARCTRL_AR_DEPT_CODE,
i.  ARCTRL_AR_ACC_CODE,
i.  ARCTRL_FC_CR_DEPT_CODE,
i.  ARCTRL_FC_CR_ACC_CODE,
i.  ARCTRL_FC_DR_DEPT_CODE,
i.  ARCTRL_FC_DR_ACC_CODE,
i.  ARCTRL_SLS_DEPT_CODE,
i.  ARCTRL_SLS_ACC_CODE,
i.  ARCTRL_MISC_DEPT_CODE,
i.  ARCTRL_MISC_ACC_CODE,
i.  ARCTRL_FRT_DEPT_CODE,
i.  ARCTRL_FRT_ACC_CODE,
i.  ARCTRL_INS_DEPT_CODE,
i.  ARCTRL_INS_ACC_CODE,
i.  ARCTRL_HLDBK_DEPT_CODE,
i.  ARCTRL_HLDBK_ACC_CODE,
i.  ARCTRL_CASH_DEPT_CODE,
i.  ARCTRL_CASH_ACC_CODE,
i.  ARCTRL_CR_CASH_DEPT_CODE,
i.  ARCTRL_CR_CASH_ACC_CODE,
i.  ARCTRL_DISC_DEPT_CODE,
i.  ARCTRL_DISC_ACC_CODE,
i.  ARCTRL_WO_DEPT_CODE,
i.  ARCTRL_WO_ACC_CODE,
i.  ARCTRL_ALLOW_DEPT_CODE,
i.  ARCTRL_ALLOW_ACC_CODE,
i.  ARCTRL_DPST_DEPT_CODE,
i.  ARCTRL_DPST_ACC_CODE,
i.  ARCTRL_CURR_FLUC_DEPT_CODE,
i.  ARCTRL_CURR_FLUC_ACC_CODE,
i.  ARCTRL_FCSUM_CODE,
i.  ARCTRL_HLDBK_TYPE_CODE,
i.  ARCTRL_SHPLNE_CODE,
i.  ARCTRL_DUNN_CODE,
i.  ARCTRL_COLL_CODE,
i.  ARCTRL_SMAN1_CODE,
i.  ARCTRL_SMAN2_CODE,
i.  ARCTRL_SMAN3_CODE,
i.  ARCTRL_TAXED_CODE,
i.  ARCTRL_TAX1_CODE,
i.  ARCTRL_TAX2_CODE,
i.  ARCTRL_TAX3_CODE,
i.  ARCTRL_CURR_CODE,
i.  ARCTRL_SDISC_CODE,
i.  ARCTRL_CR_LIMIT_AMT,
i.  ARCTRL_SEQ_CODE,
i.  ARCTRL_H_CODE,
i.  ARCTRL_CUSTCL_CODE,
i.  ARCTRL_CUST_TERM_CODE,
i.  ARCTRL_CUST_CHRG_CODE,
i.  ARCTRL_TERR_CODE,
i.  ARCTRL_INV_PRT_NUM,
i.  ARCTRL_COUNTRY,
i.  ARCTRL_PAY_H_NUM,
i.  ARCTRL_INV_H_NUM,
i.  ARCTRL_PSTALLBCH_CODE,
i.  ARCTRL_TICKET_CODE,
i.  ARCTRL_AGING_METHOD_FLAG,
i.  ARCTRL_CUST_DUNNING_FLAG,
i.  ARCTRL_DUNNING_WIDTH_NUM,
i.  ARCTRL_DUNNING_LENGTH_NUM,
i.  ARCTRL_RESTRICT_POST_FLAG,
i.  ARCTRL_CURR_YR,
i.  ARCTRL_CURR_PER,
i.  ARCTRL_BCH_TOTAL_FLAG,
i.  ARCTRL_CUST_NAME_UPPER_FLAG,
i.  ARCTRL_CUST_ADDR_UPPER_FLAG,
i.  ARCTRL_WO_MAX_PERCENT,
i.  ARCTRL_WO_MAX_AMT,
i.  ARCTRL_MAX_WO_PERCENT,
i.  ARCTRL_TAX_WO_DEPT_CODE,
i.  ARCTRL_TAX_WO_ACC_CODE,
i.  ARCTRL_ALLOW_INV_OVERPAY_FLAG,
i.  ARCTRL_DISC_ALWAYS_DISP_FLAG,
i.  ARCTRL_DEFAULT_TERM_CODE,
i.  ARCTRL_INV_SERIES_FLAG,
i.  ARCTRL_DEFAULT_AR_DEPT_FLAG,
i.  ARCTRL_BANK_CODE,
i.  ARCTRL_EXCHG_RATE_TYPE,
i.  ARCTRL_INV_SER_CODE,
i.  ARCTRL_MAX_PRICE_CHG_PC,
i.  ARCTRL_TAXES_NUM,
i.  ARCTRL_DAYS_TO_PAY_CUTOFF_DAYS,
i.  ARCTRL_LOCKBOX_FILE_PATH,
i.  ARCTRL_LOCKBOX_FILE_PATTERN,
i.  ARCTRL_MAX_AUTO_CHQ_WO_AMOUNT,
i.  ARCTRL_AUTO_WOFF_CODE,
i.  ARCTRL_CHRGBACK_WOFF_COPIES,
i.  ARCTRL_LOGO_FILE,
i.  ARCTRL_DEFAULT_PAY_TYPE_CODE,
i.  ARCTRL_CASH_RCT_CUST_CODE,
i.  ARCTRL_DFLT_CORP_ADD_CODE,
i.  ARCTRL_RETAIN_CREDIT_TAX1_FLAG,
i.  ARCTRL_ALLOW_DATE_NOT_CURR_PER,
i.  ARCTRL_POST_PRIOR_DEPOSIT_FLAG,
i.  ARCTRL_POST_FUTURE_FLAG,
i.  ARCTRL_CUST_COLL_CODE,
i.  ARCTRL_DISREG_INACT_FLAG,
i.  ARCTRL_CASH_RCT_CASH_ACC_FLAG,
--i.  ARCTRL__IU__CREATE_DATE,
--i.  ARCTRL__IU__CREATE_USER,
--i.  ARCTRL__IU__UPDATE_DATE,
--i.  ARCTRL__IU__UPDATE_USER,
i.  ARCTRL_FOFFI_CASH_RCT_FLAG,
i.  ARCTRL_CALC_TAX_ON_FLAG,
i.  ARCTRL_SYNC_SELF_SUB_INVOICE
);
end loop;
--commit;
select count(1) into v_cnt_conv from ARCTRL@conv;
select count(1) into v_cnt_prod from ARCTRL@prod;
if v_cnt_conv - v_cnt_prod = 0
then
dbms_output.put_line ('Number of records in PROD match with CONV for ARCTRL table.');
else
dbms_output.put_line ('Number of records in PROD does not match with CONV for ARCTRL table.');
Raise record_count_mismatch;
end if;
Select count(1) into v_cnt from DA.ARCTRL@PROD where ARCTRL_comp_code not in ('ZZ');
dbms_output.put_line ('Inserted '||v_cnt||' records into ARCTRL table, check and commit.');
EXCEPTION
WHEN record_count_mismatch
THEN
DBMS_OUTPUT.PUT_LINE ('There is a mismatch in PROD and CONV for this table.');
WHEN OTHERS 
THEN
DBMS_OUTPUT.PUT_LINE ('ERROR WHILE INSERTING INTO DA.ARCTRL.');
DBMS_OUTPUT.PUT_LINE (SQLERRM);

end;
/ 